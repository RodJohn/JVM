

# 类加载

## 概述

    JVM把Class文件流加载到内存，
    并对数据进行校验、转换解析、初始化，
    使这些数据最终成为可以被JVM直接使用的Java类型

## 特点

动态加载 

	类的加载是在程序的运行期间完成 
	也就是在运行期间可以决定加载哪些类

缓存机制

	缓存机制将会保证所有加载过的Class都会被缓存，
	当程序中需要使用某个Class时，类加载器先从缓存区寻找该Class，
	只有缓存区不存在，系统才会读取该类对应的二进制数据，并将其转换成Class对象，存入缓存区。
	这就是为什么修改了Class后，必须重启JVM，程序的修改才会生效



# 加载周期	

## 周期

	类加载周期由 加载，连接，初始化等三个组成。
	其中连接分为验证，准备，解析
  


##  热部署

	热部署是在不重启 Java 虚拟机的前提下，能自动侦测到 class 文件的变化，更新运行时 class 的行为。Java 类是通过 Java 虚拟机加载的，某个类的 class 文件在被 classloader 加载后，会生成对应的 Class 对象，之后就可以创建该类的实例。默认的虚拟机行为只会在启动时加载类，如果后期有一个类需要更新的话，单纯替换编译的 class 文件，Java 虚拟机是不会更新正在运行的 class。如果要实现热部署，最根本的方式是修改虚拟机的源代码，改变 classloader 的加载行为，使虚拟机能监听 class 文件的更新，重新加载 class 文件，这样的行为破坏性很大，为后续的 JVM 升级埋下了一个大坑。
	
	另一种友好的方法是创建自己的 classloader 来加载需要监听的 class，这样就能控制类加载的时机，从而实现热部署。
	
	 热部署步骤：
	1、销毁自定义classloader(被该加载器加载的class也会自动卸载)；
	2、更新class
	3、使用新的ClassLoader去加载class
