
# 引用类型

	Java的四种引用。包括：强引用，软引用，弱引用，虚引用。

# 强引用

    默认的Object object=new Object()的形式中,
    object即是对象new Object()的强引用，
    只有在object这个引用被释放后，对象才会被释放掉。
    如果一个引用是强引用，即使内存不足，GC也绝对不会回收它，而是宁可抛出OutOfMemoryError错误。


强引用是使用最普遍的引用。
如果一个对象具有强引用，那垃圾回收器绝不会回收它。
当内存空间不足，Java虚拟机宁愿抛出OutOfMemoryError错误，使程序异常终止，也不会靠随意回收具有强引用的对象来解决内存不足的问题。

ps：强引用其实也就是我们平时A a = new A()这个意思。

强引用特性

强引用可以直接访问目标对象。
强引用所指向的对象在任何时候都不会被系统回收。
强引用可能导致内存泄漏。



Final Reference

当前类是否是finalizer类，注意这里finalizer是由JVM来标志的( 后面简称f类 )，并不是指java.lang.ref.Finalizer类。但是f类是会被JVM注册到java.lang.ref.Finalizer类中的。

① 当前类或父类中含有一个参数为空，返回值为void的名为finalize的方法。
② 并且该finalize方法必须非空


GC 回收问题

对象因为Finalizer的引用而变成了一个临时的强引用，即使没有其他的强引用，还是无法立即被回收；
对象至少经历两次GC才能被回收，因为只有在FinalizerThread执行完了f对象的finalize方法的情况下才有可能被下次GC回收，而有可能期间已经经历过多次GC了，但是一直还没执行对象的finalize方法；
CPU资源比较稀缺的情况下FinalizerThread线程有可能因为优先级比较低而延迟执行对象的finalize方法；
因为对象的finalize方法迟迟没有执行，有可能会导致大部分f对象进入到old分代，此时容易引发old分代的GC，甚至Full GC，GC暂停时间明显变长，甚至导致OOM；
对象的finalize方法被调用后，这个对象其实还并没有被回收，虽然可能在不久的将来会被回收。




    
##  软引用

特点
    
    如果一个对象仅有软引用，那么当内存充足时，GC不会回收它，当内存不足时，GC会对其回收。
    此时，需要通过sf.get()方法可以取到这个对象，当然，当这个对象被标记为需要回收的对象时，则返回null；

作用

    软引用主要用户实现类似缓存的功能，在内存足够的情况下直接通过软引用取值，无需从繁忙的真实来源查询数据，提升速度；
    当内存不足时，自动删除这部分缓存数据，从真正的来源查询这些数据。

    通常情况下，软引用可以和一个引用队列共同使用。
    即当软引用的对象被GC回收后，JVM把这个软引用加入与之关联的队列中。软引用实例如下：











